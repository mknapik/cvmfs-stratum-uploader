<VirtualHost *:80>
  ServerAdmin michael.knapik@stfc.ac.uk
  ServerName t1student0.esc.rl.ac.uk
  RewriteEngine on
  RewriteRule ^/(.*) https://t1student0.esc.rl.ac.uk/$1 
</VirtualHost>

WSGIPythonPath /var/www/t1student0.esc.rl.ac.uk:/home/vwa13376/workspace/archer/venv/lib/python2.7/site-packages

<VirtualHost *:443>
  ServerAdmin michael.knapik@stfc.ac.uk
  ServerName t1student0.esc.rl.ac.uk
  DocumentRoot /var/www

#  ErrorLog /tmp/error_log
#  CustomLog /tmp/access_log common

  SSLProtocol all -SSLv2
  SSLCipherSuite ALL:!ADH:!EXPORT:!SSLv2:RC4+RSA:+HIGH:+MEDIUM:-LOW

  SSLEngine on
  SSLVerifyClient none
  SSLCertificateFile    /home/vwa13376/workspace/certs/eScience/hostcert.pem
  SSLCertificateKeyFile /home/vwa13376/workspace/certs/eScience/hostkey.pem
  SSLCACertificatePath  /home/vwa13376/workspace/certs/certificates
#  SSLCACertificateFile  /home/vwa13376/workspace/certs/certificates/UKeScienceRoot-2007.pem
#  SSLCACertificateFile  /home/vwa13376/workspace/certs/certificates/UKeScienceCA-2B.pem

  <Location />
    SSLVerifyClient none
  </Location>

  <Location /cert>
    SSLVerifyClient require
    SSLVerifyDepth 2
    SSLOptions +ExportCertData
  </Location>

  <Location /fake>
    SSLRequireSSL
    SSLVerifyClient require
    SSLVerifyDepth 4
    SSLOptions +StdEnvVars +ExportCertData +FakeBasicAuth
  </Location>

  <Location "/basic">
    SSLRequireSSL
    AuthType Basic
    AuthName "Top Secret"
    Require valid-user
    AuthBasicProvider wsgi
    WSGIAuthUserScript /var/www/t1student0.esc.rl.ac.uk/archer.wsgi
  </Location>

  WSGIScriptAlias /cert /var/www/t1student0.esc.rl.ac.uk/archer.wsgi
  WSGIScriptAlias "/basic" /var/www/t1student0.esc.rl.ac.uk/archer.wsgi
  WSGIScriptAlias /fake /var/www/t1student0.esc.rl.ac.uk/archer.wsgi
  WSGIScriptAlias / /var/www/t1student0.esc.rl.ac.uk/archer.wsgi
#  WSGIScriptAlias /archer /var/www/t1student0.esc.rl.ac.uk/archer/wsgi.py
  Alias /archer/static /var/www/t1student0.esc.rl.ac.uk/static
  <Directory /var/www/t1student0.esc.rl.ac.uk>
    Order allow,deny
    Allow from all
    <Files dev.sqlite3>
      Order deny,allow
      Require all granted
    </Files>
  </Directory>
  <Directory /var/www/t1student0.esc.rl.ac.uk/uploads>

    Order allow,deny
    Allow from all
  </Directory>
  <Directory /var/www/t1student0.esc.rl.ac.uk/archer>
    <Files wsgi.py>
      Order deny,allow
      Require all granted
    </Files>
  </Directory>
</VirtualHost>

